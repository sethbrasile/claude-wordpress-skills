---
phase: 02-plugin-development
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/wp-plugin-development/SKILL.md
autonomous: true

must_haves:
  truths:
    - "Claude can detect plugin header issues, missing prefixing, broken activation/deactivation/uninstall lifecycle, and WordPress.org compliance failures in WordPress plugin code"
    - "Claude reports findings grouped by file with severity (CRITICAL/WARNING/INFO), line numbers, and BAD/GOOD code pairs"
    - "Claude distinguishes plugin distribution context (WordPress.org submission, private plugin, mu-plugin, drop-in) to adjust severity"
    - "Claude can run grep-based quick detection from the Search Patterns section"
    - "Claude automatically activates this skill from trigger phrases like 'plugin review', 'WordPress.org submission', 'plugin best practices'"
    - "Security-relevant findings cross-reference wp-security-review instead of duplicating patterns"
  artifacts:
    - path: "skills/wp-plugin-development/SKILL.md"
      provides: "Complete plugin development review skill with 12 sections matching security/performance skill structure"
      min_lines: 450
      contains: "name: wp-plugin-development"
  key_links:
    - from: "skills/wp-plugin-development/SKILL.md"
      to: "references/*.md"
      via: "Deep-Dive References table"
      pattern: "references/architecture-patterns\\.md|references/hooks-guide\\.md|references/oop-patterns\\.md|references/api-patterns\\.md"
    - from: "skills/wp-plugin-development/SKILL.md"
      to: "skills/wp-security-review/SKILL.md"
      via: "Cross-reference for security concerns"
      pattern: "wp-security-review|/wp-sec-review"
---

<objective>
Create the main SKILL.md for wp-plugin-development -- the core skill file that teaches Claude how to review WordPress plugin architecture and WordPress.org submission compliance.

Purpose: This is the primary deliverable of Phase 2. It defines the complete plugin review workflow, detection patterns for plugin headers, lifecycle hooks, prefixing, CPT/taxonomies, Settings API, hooks system, i18n, and WordPress.org Plugin Check compliance. Cross-references wp-security-review for security concerns instead of duplicating.

Output: `skills/wp-plugin-development/SKILL.md` (~500+ lines) with 12 sections mirroring the existing wp-security-review and wp-performance-review skill structure.
</objective>

<execution_context>
@/Users/seth/.claude/get-shit-done/workflows/execute-plan.md
@/Users/seth/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-plugin-development/02-CONTEXT.md
@.planning/phases/02-plugin-development/02-RESEARCH.md
@skills/wp-performance-review/SKILL.md
@skills/wp-security-review/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SKILL.md with YAML frontmatter and 12-section structure</name>
  <files>skills/wp-plugin-development/SKILL.md</files>
  <action>
Create `skills/wp-plugin-development/SKILL.md` following the EXACT section structure of the existing `skills/wp-security-review/SKILL.md` and `skills/wp-performance-review/SKILL.md` (use them as structural templates) but with plugin development content.

**YAML Frontmatter (PLG-01):**
- `name: wp-plugin-development`
- `description:` Must include trigger phrases and fit within 1024 characters. Include: "WordPress plugin architecture review and WordPress.org submission standards", "plugin review", "plugin best practices", "WordPress.org submission", "Plugin Check", "plugin headers", "activation hook", "deactivation hook", "uninstall", "custom post type", "taxonomy", "Settings API", "hooks", "actions", "filters", "internationalization", "i18n", "text domain", "prefixing", "namespacing". Describe what the skill reviews (plugin architecture, lifecycle hooks, CPT/taxonomies, Settings API, hooks, i18n, WordPress.org compliance).

**12 Sections (mirror security/performance skill layout):**

1. **Overview** -- Systematic plugin architecture review for WordPress. Core principle: WordPress plugins extend functionality through a standardized API ecosystem -- lifecycle hooks, Settings API, hooks system, and i18n. Review validates architecture, naming conventions, WordPress.org compliance, and cross-references security skill for auth/nonce patterns. Report with line numbers, severity, and BAD/GOOD code pairs.

2. **When to Use / Don't Use** -- Use for: plugin code review, WordPress.org pre-submission check, architecture audit, custom post type / taxonomy review, Settings API validation, hooks system review, i18n audit. Don't use for: theme development (use wp-theme-development), Gutenberg block code (use wp-block-development), WooCommerce extensions (use wp-woocommerce-development), security-only audits (use wp-security-review), performance-only audits (use wp-performance-review).

3. **Code Review Workflow** -- 6-step workflow:
   1. Identify plugin type and context (WordPress.org / private / mu-plugin / drop-in)
   2. Check plugin header completeness and metadata
   3. Scan for CRITICAL patterns (missing ABSPATH check, unprefixed functions/classes in global scope, missing activation/deactivation hooks, text domain mismatch, no uninstall cleanup)
   4. Check WARNING patterns (missing i18n, hardcoded paths, flush_rewrite_rules on every init, missing sanitize_callback in register_setting)
   5. Note INFO improvements (could use namespaces, show_in_rest for Gutenberg support, conditional admin/public loading)
   6. Apply context-aware severity (WordPress.org = strictest, private = more flexible, mu-plugin = no activation hooks needed)
   Report using output format below. If security concerns found, suggest running /wp-sec-review.

4. **File-Type Specific Checks** -- Organized by file type:
   - **Main plugin file** (PLG-02, PLG-03, PLG-04): Plugin header completeness (required fields: Plugin Name; recommended: Version, Description, Author, Text Domain, Requires at least, Requires PHP, License), ABSPATH check, prefix convention (4-5 char unique prefix on all functions/classes/global variables/options), activation/deactivation hooks present
   - **uninstall.php** (PLG-05): WP_UNINSTALL_PLUGIN constant check, cleanup of options, transients, custom tables, user meta
   - **Custom post type / taxonomy files** (PLG-06, PLG-07): register_post_type() on init hook, post type key <= 20 chars, prefixed key, show_in_rest for Gutenberg, flush_rewrite_rules ONLY in activation hook (not init), register_taxonomy() params, taxonomy name <= 32 chars
   - **Settings files** (PLG-08, PLG-09): register_setting() with sanitize_callback and type, add_settings_section/add_settings_field proper linking, settings_fields() and do_settings_sections() in form HTML, get_option()/update_option() with prefixed option names
   - **Hooks usage** (PLG-10): add_action/add_filter with correct priority and accepted_args, filters MUST return value, remove_action/remove_filter must match exact registration params (including priority), custom hooks with do_action/apply_filters for extensibility
   - **i18n files** (PLG-11): Text domain matches plugin slug exactly (lowercase, dashes not underscores), __()/_e()/_n()/_x() have text domain parameter, no variables embedded in translatable strings (use sprintf), load_plugin_textdomain() on init, esc_html__()/esc_attr__() for escaped+translated output
   - **REST API endpoints** (PLG-13, surface-level): register_rest_route() on rest_api_init, namespace includes version (e.g., myplugin/v1), permission_callback present (cross-ref wp-security-review for depth), args with sanitize_callback and validate_callback
   - **AJAX handlers** (PLG-14, surface-level): wp_ajax_ and wp_ajax_nopriv_ hooks registered, check_ajax_referer() present (cross-ref wp-security-review)
   - **Admin menus** (PLG-15, surface-level): add_menu_page/add_submenu_page with capability param, capability check in page callback
   - **Database tables** (PLG-16, surface-level): $wpdb->prefix used for table names, dbDelta() for table creation (not $wpdb->query), require_once upgrade.php, charset_collate
   - **Cron jobs** (PLG-17, surface-level): wp_schedule_event() with schedule check (wp_next_scheduled), cleared on deactivation
   - **Transients** (PLG-18, surface-level): set_transient() with expiration, prefixed transient names

   Each check item includes: pattern to find, severity level, brief explanation.

5. **Search Patterns for Quick Detection (PLG-21)** -- Bash grep commands organized by severity:
   - CRITICAL: Plugin file without Plugin Name header, PHP files without `defined( 'ABSPATH' )`, unprefixed function declarations (`function [a-z_]+\(` without plugin prefix), text domain mismatch between header and usage, `flush_rewrite_rules` outside activation/deactivation hooks, filter callbacks missing return statement, register_rest_route without permission_callback
   - WARNING: Missing register_activation_hook, missing uninstall.php or register_uninstall_hook, __()/_e() without text domain parameter, hardcoded `/wp-content/plugins/` paths, $wpdb->query for CREATE TABLE (should use dbDelta), post type key > 20 chars, missing show_in_rest in register_post_type
   - INFO: Missing `Requires at least` or `Requires PHP` in header, functions not using namespaces, admin code loading on frontend (missing is_admin check), missing Domain Path in header

   Use comments to explain each grep. These patterns are used by /wp-plugin quick scan.

6. **Platform Context** (PLG-12) -- Context-aware review notes:
   - **WordPress.org submission**: Strictest standards. Plugin Check (PCP) tool enforces: proper headers, text domain matching slug, ABSPATH check on all files, no deprecated functions, license compatibility (GPLv2+), readme.txt with proper format. Suggest running `wp plugin check my-plugin.php` before submission.
   - **Private/enterprise plugins**: More flexibility on naming. No readme.txt required. Can use proprietary license. Still need proper prefixing and lifecycle hooks.
   - **Must-use plugins (mu-plugins)**: Different loading behavior -- loaded alphabetically before regular plugins, no activation/deactivation hooks, can't be deactivated via admin UI. Adjust review to skip activation hook checks.
   - **Drop-in plugins**: Special files (object-cache.php, db.php, advanced-cache.php). Very different pattern -- skip standard plugin checks.

7. **Quick Reference: Plugin Architecture Patterns** -- Organized by concern with BAD/GOOD code pairs (PLG-22). Cover the deep-coverage areas:
   - Plugin Headers -- complete header block with all recommended fields
   - Prefixing and Namespacing -- function/class/option/transient prefix patterns, PHP namespace alternative
   - Activation/Deactivation/Uninstall Lifecycle -- register_activation_hook, register_deactivation_hook, uninstall.php with WP_UNINSTALL_PLUGIN check
   - Custom Post Types and Taxonomies -- register_post_type/register_taxonomy with proper args, flush_rewrite_rules on activation only
   - Settings API -- register_setting + add_settings_section + add_settings_field + form output workflow
   - Hooks System -- action vs filter distinction, priority, accepted_args, return requirement for filters, remove hook matching
   - Internationalization -- text domain matching, sprintf for placeholders, _n() for plurals, _x() for context, escaped variants
   Plus surface-level patterns:
   - REST API Registration -- register_rest_route with namespace/version/permission_callback
   - AJAX Handlers -- wp_ajax_ hook pattern
   - Conditional Loading -- is_admin() to separate admin/public code
   - Function/Class Existence Checks (PLG-19) -- function_exists(), class_exists() wrappers
   - Conditional Loading (PLG-20) -- is_admin() separation

   ALL code examples MUST follow WordPress PHP Coding Standards: spaces inside parentheses, array() not [], Yoda conditions, snake_case, prefixed functions.
   ALL code pairs use BAD/GOOD pattern.

8. **Severity Definitions (PLG-23)** -- Table matching security/performance skill format:
   - CRITICAL: Will cause WordPress.org rejection OR breaks plugin functionality (missing Plugin Name header, unprefixed globals causing collisions, text domain mismatch, missing ABSPATH check, direct DB table creation without dbDelta, filter without return)
   - WARNING: Non-standard patterns that cause maintainability or compatibility issues (missing i18n, hardcoded paths, tight coupling, missing uninstall cleanup, flush_rewrite_rules on every init)
   - INFO: Best practice improvements (could use namespaces, missing show_in_rest, admin code loading on frontend, missing version requirements in header)

9. **Output Format (PLG-23)** -- Match security/performance skill format exactly:
   - Group findings by FILE
   - Each finding: line number, severity, issue description, explanation, BAD/GOOD code pair with fix
   - Summary at end with total counts by severity
   - If security concerns found, add note: "Security issues detected. Run `/wp-sec-review` for comprehensive security analysis."

10. **Common Mistakes (PLG-24)** -- Table of patterns that look like issues but are NOT:
    - mu-plugins don't need activation hooks (they load automatically)
    - Drop-in plugins don't follow standard plugin header format
    - Private plugins don't need readme.txt
    - `__return_true` in REST permission_callback is correct for public read-only endpoints
    - Settings API sanitize_callback returning different type than input is valid (e.g., checkbox returns bool from string)
    - Text domain not needed for core WordPress strings passed to wp_die() etc.
    - Short prefix (3 chars) acceptable if namespace is unique enough in context
    - Activation hook not needed if plugin has no setup requirements
    Add more from RESEARCH.md common pitfalls.

11. **WordPress.org Compliance Checklist (PLG-12)** -- Quick checklist for Plugin Check standards:
    - [ ] Plugin Name header present
    - [ ] Text domain matches plugin slug (lowercase, dashes)
    - [ ] All PHP files have ABSPATH check
    - [ ] All i18n functions include text domain
    - [ ] No deprecated functions
    - [ ] License header present (GPLv2+)
    - [ ] readme.txt with proper format (or readme.md)
    - [ ] No hardcoded /wp-content/ paths
    - [ ] Proper prefixing on all global-scope functions/classes/options
    - [ ] uninstall.php or register_uninstall_hook present

12. **Deep-Dive References** -- Table linking to companion reference docs:
    | Task | Reference to Load |
    |------|-------------------|
    | Plugin file structure and architecture | `references/architecture-patterns.md` |
    | Actions and filters deep dive | `references/hooks-guide.md` |
    | OOP patterns and namespacing | `references/oop-patterns.md` |
    | Settings API, REST API, database, transients | `references/api-patterns.md` |

**Content sourcing:** Use 02-RESEARCH.md extensively -- it has verified code examples, API tables, and patterns. Adapt and organize into SKILL.md sections. The SKILL.md should be concise and actionable, with reference docs handling deep dives.

**Critical constraint:** The SKILL.md must be SELF-SUFFICIENT for a standard plugin review. Reference docs add depth but are not required for basic reviews.

**Security crossover (LOCKED DECISION):** Do NOT duplicate security patterns. When encountering security-relevant patterns (form handler without nonce, AJAX without capability check), include a brief reminder of the three-step pattern (nonce + capability + sanitize) and add: "See wp-security-review skill for detailed security analysis" or suggest /wp-sec-review.
  </action>
  <verify>
- File exists at `skills/wp-plugin-development/SKILL.md`
- YAML frontmatter has `name: wp-plugin-development` and `description` under 1024 chars with trigger phrases
- All 12 sections present (check for ## headings matching the template)
- Code examples use WordPress PHP Coding Standards (spaces in parentheses, array() not [])
- BAD/GOOD pattern used consistently
- Severity levels (CRITICAL/WARNING/INFO) used correctly per plugin definitions
- Search Patterns section has runnable bash grep commands
- Deep-Dive References table lists all 4 reference docs
- Security cross-references present (mentions wp-security-review, /wp-sec-review)
- Context-aware detection for WordPress.org vs private vs mu-plugin vs drop-in
- File is at least 450 lines
  </verify>
  <done>
SKILL.md exists with all 12 sections, correct frontmatter, detection patterns for plugin headers/lifecycle/CPT/Settings API/hooks/i18n/WordPress.org compliance, grep patterns for quick scan, output format grouped by file, common false-positive table, WordPress.org compliance checklist, security cross-references, and reference doc links. All code examples follow WP PHP Coding Standards with BAD/GOOD pairs.
  </done>
</task>

</tasks>

<verification>
- `skills/wp-plugin-development/SKILL.md` exists with valid YAML frontmatter
- `name` field is `wp-plugin-development`
- `description` field is under 1024 characters and includes trigger phrases
- File has 12 major sections matching security/performance skill structure
- All deep-coverage areas have detection patterns and code examples (headers, lifecycle, CPT/taxonomies, Settings API, hooks, i18n)
- All surface-level areas have scan patterns + brief guidance (REST API, AJAX, admin menus, DB tables, cron, transients)
- Context-aware detection present (WordPress.org, private, mu-plugin, drop-in)
- Common Mistakes table has at least 8 false-positive scenarios
- Search Patterns section has categorized grep commands
- Security cross-references present throughout (not duplicating security patterns)
- Output format matches security/performance skills (grouped by file, BAD/GOOD pairs)
- Requirements PLG-01 through PLG-24 are covered
</verification>

<success_criteria>
- SKILL.md is a complete, self-sufficient plugin review guide that Claude can follow
- All PLG requirements mapped to this plan (PLG-01 through PLG-24) are covered
- Structure mirrors wp-security-review/SKILL.md and wp-performance-review/SKILL.md exactly (12 sections, same ordering)
- A Claude instance could perform a meaningful WordPress plugin review using ONLY this SKILL.md
- Security concerns cross-reference wp-security-review instead of duplicating
</success_criteria>

<output>
After completion, create `.planning/phases/02-plugin-development/02-01-SUMMARY.md`
</output>
